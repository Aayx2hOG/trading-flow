generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String     @id @default(cuid())
  email     String     @unique
  username  String     @unique
  password  String
  workflows Workflow[]
}

model Workflow {
  id         String      @id @default(cuid())
  user       User        @relation(fields: [userId], references: [id])
  userId     String
  nodes      Json        @default("[]")
  edges      Json        @default("[]")
  executions Execution[]

  @@index([userId])
}

enum ExecutionStatus {
  SUCCESS
  FAILURE
}

model Execution {
  id         String          @id @default(cuid())
  workflowId String
  workflow   Workflow        @relation(fields: [workflowId], references: [id])
  status     ExecutionStatus
  startTime  DateTime        @default(now())
  endTime    DateTime?

  @@index([workflowId])
  @@index([status])
}
